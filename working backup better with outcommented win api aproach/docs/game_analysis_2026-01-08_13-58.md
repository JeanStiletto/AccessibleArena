# MTGA Game Analysis

Date: 2026-01-08 13:58
Game Version: 0.1.10849.1221064

## Game Structure

Engine: Unity with Mono runtime (MonoBleedingEdge)
Install Path: C:\Program Files\Wizards of the Coast\MTGA

### Key Directories

- MTGA_Data\Managed - .NET assemblies (modding target)
- MTGA_Data\StreamingAssets - Audio and configuration
- MelonLoader folder - Mod framework (after installation)

## Analyzed Assemblies

### Assembly-CSharp.dll (314 KB)

Main game code assembly. Heavy dependencies prevent full reflection analysis.
Only 1 type loadable without full dependency chain.

### Core.dll (11.8 MB)

268 types analyzed. Contains interfaces for game systems.

#### Card Text Interfaces

Wotc.Mtga.Cards.Text.ICardTextEntry
- Method: String GetText()

Wotc.Mtga.Cards.Text.ILoyaltyTextEntry
- Method: String GetCost()

Wotc.Mtga.DuelScene.Browsers.IHeaderTextProvider
- Method: String GetText()

#### Card View Interfaces

Wotc.Mtga.DuelScene.ICardView
- Property: UInt32 InstanceId

Wotc.Mtga.DuelScene.ICardViewController
- Method: Void DeleteCard(UInt32[] cardIds)

ICardBrowserProvider
- Property: Boolean ApplyTargetOffset
- Property: Boolean ApplySourceOffset
- Property: Boolean ApplyControllerOffset
- Method: String GetCardHolderLayoutKey()

Wotc.Mtga.ICardRolloverZoom
- Property: Boolean IsActive
- Method: Void Close()
- Method: Void Destroy()

#### Hover and Interaction Interfaces

Wotc.Mtga.DuelScene.IPlayerPresenceController
- Method: Void SetHoveredCardId(UInt32 id)

IHoverableZone
- No public methods/properties visible

Wotc.Mtga.DuelScene.IAvatarHoverController
- Method: Void BeginAvatarHover(IAvatarView avatarView)
- Method: Void EndAvatarHover(IAvatarView avatarView)

#### Input Handler Interfaces

Core.Code.Input.IAcceptActionHandler
- Method: Void OnAccept()

Core.Code.Input.INextActionHandler
- Method: Void OnNext()

Core.Code.Input.IPreviousActionHandler
- Method: Void OnPrevious()

Core.Code.Input.INavigateActionHandler
- No public methods visible

Core.Code.Input.IFindActionHandler
- Method: Void OnFind()

Core.Code.Input.IAltViewActionHandler
- Method: Void OnOpenAltView()
- Method: Void OnCloseAltView()

Core.Code.Input.ITextActionHandler
- Method: Void OnTextInput(Char inputtedCharacter)

#### Game State Interfaces

Wotc.Mtga.DuelScene.IGameStateManager
- No public methods visible

Wotc.Mtga.DuelScene.IGameStateProvider
- No public methods visible

Wotc.Mtga.DuelScene.IGameStateController
- No public methods visible

Wotc.Mtga.DuelScene.ITurnInfoProvider
- Property: UInt32 EventTranslationTurnNumber

Wotc.Mtga.DuelScene.IMatchSceneStateController
- No public methods visible

#### Zone and Battlefield Interfaces

IBattlefieldStack
- Property: Boolean HasAttachmentOrExile
- Property: UInt32 Age
- Property: Boolean IsAttackStack
- Property: Boolean IsBlockStack
- Property: Int32 AttachmentCount
- Property: Int32 ExileCount
- Method: Void RefreshAbilitiesBasedOnStackPosition()

Wotc.Mtga.DuelScene.ZoneCounts.IZoneCountController
- Method: Void DeleteZoneCount(UInt32 playerId)

#### UI Interfaces

Wotc.Mtga.ITooltipDisplay
- No public methods visible

Wotc.Mtga.DuelScene.IAvatarView
- Property: Boolean IsLocalPlayer
- Property: Boolean ShowingPlayerName
- Method: Void ShowPlayerNames(Boolean visible)

ISelectCardsBrowserProvider
- Property: Boolean AllowKeyboardSelection

### Wizards.Arena.Models.dll (141 KB)

550 types analyzed. Contains data models and DTOs.

#### Card Data Models

Wizards.Models.ClientBusinessEvents.CardMulliganedData
- Property: UInt32 grpId
- Property: String name

Wizards.Unification.Models.Cards.CardCategory
- Method: Boolean IsWildcard(UInt32 grpId)

Wizards.Unification.Models.Cards.CardNickname
- Card nickname storage

Wizards.Unification.Models.Cards.CardsAndQuantity
- Dictionary of card IDs to quantities

Wizards.Unification.Models.Events.CardDisplayData
- Card display information

Wizards.Unification.Models.Mercantile.ClientCardView
- Client-side card view data

#### Deck Models

Wizards.Unification.Models.Deck.Deck
- Method: Void CopyTo(Deck other)
- Method: Boolean IsEqual(Deck other)

Wizards.Unification.Models.Deck.DeckCard
- Individual card in deck

Wizards.Unification.Models.Deck.DTO_DeckSummary
- Method: Void CopyTo(DTO_DeckSummary other)

Wizards.Unification.Models.Deck.CardSkin
- Card skin/style data

#### Game Event Models

Wizards.Models.ClientBusinessEvents.DuelSceneGameStart
- Property: ClientBusinessEventType EventType
- Property: DateTime EventTime

Wizards.Models.ClientBusinessEvents.DuelSceneGameStop
- Property: ClientBusinessEventType EventType
- Property: DateTime EventTime

Wizards.Models.ClientBusinessEvents.DuelSceneEndOfMatchReport
- Match end reporting

#### Draft Models

Wizards.Unification.Models.Draft.PlayerDraftReserveCardRequest
- Property: String DraftId
- Property: List GrpIds
- Property: Int32 Pack
- Property: Int32 Pick

#### Net Deck Models

Wizards.Unification.Models.NetDeck.DTO_NetDeckFolder
- Property: Guid Id
- Property: String FolderNameLocKey
- Property: String FolderDescLocKey

## Key Identifiers

### Card Identifier

Cards use grpId (UInt32) as unique identifier across the system.
This ID is used in:
- Card display
- Deck building
- Draft picks
- Hover events

### Instance Identifier

In-game card instances use InstanceId (UInt32) to track specific cards on the battlefield.

### Player Identifier

Players identified by playerId (UInt32).

## Accessibility Hook Points

### Priority 1: Card Information

1. Wotc.Mtga.Cards.Text.ICardTextEntry.GetText()
   - Returns card text for display
   - Hook to intercept and speak card text

2. Wotc.Mtga.DuelScene.IPlayerPresenceController.SetHoveredCardId(UInt32 id)
   - Called when player hovers over a card
   - Hook to announce hovered card

3. grpId to card name mapping
   - Need to find localization/database lookup

### Priority 2: Navigation

1. Core.Code.Input.INextActionHandler.OnNext()
2. Core.Code.Input.IPreviousActionHandler.OnPrevious()
3. Core.Code.Input.IAcceptActionHandler.OnAccept()
   - Hook to announce navigation changes

### Priority 3: Game State

1. Wotc.Mtga.DuelScene.ITurnInfoProvider.EventTranslationTurnNumber
   - Track turn number

2. IGameStateManager/IGameStateProvider
   - Track game phase changes

### Priority 4: Zone Information

1. IBattlefieldStack properties
   - Track battlefield state

2. IZoneCountController
   - Track zone card counts

## Modding Approach

### Tools Required

1. MelonLoader - Mod loader framework (installed)
2. Harmony - Method patching (included with MelonLoader)
3. Tolk - Screen reader output (downloaded)

### Patching Strategy

Use Harmony Postfix/Prefix patches on:
- SetHoveredCardId to announce hovered cards
- GetText to capture card text
- OnNext/OnPrevious to announce navigation
- Game state change methods for phase announcements

### Card Data Lookup

Need to find:
- Card database loading code
- Localization system for card names
- grpId to card data mapping

## Files Generated

- analysis_core.txt - Full Core.dll analysis
- analysis_models.txt - Full Models.dll analysis
- AssemblyAnalyzer.exe - Analysis tool in libs folder

## Next Steps

1. Find card database/localization system
2. Create basic mod with Harmony patches
3. Implement hover card announcement
4. Implement navigation announcements
5. Implement game phase announcements
